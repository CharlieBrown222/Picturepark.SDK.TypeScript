<mat-expansion-panel class="aggregation" [expanded]="expandedAggregationResult?.aggregationResultItems?.length > 0" [disabled]="expandedAggregationResult?.aggregationResultItems?.length === 0">
  <mat-expansion-panel-header>
    <mat-panel-title class="aggregation__title">
      <span>
        {{ expandedAggregator?.names | pptranslate}}
      </span>
      <button mat-icon-button *ngIf="aggregationsFiltersCount > 0" [matTooltip]="'Clear filters'">
        <mat-icon aria-label="Clear filters for this category" (click)="aggregationFiltersChange.emit([]); $event.stopPropagation();">clear</mat-icon>
      </button>
    </mat-panel-title>
  </mat-expansion-panel-header>

  <!-- TODO translations, tooltip translation -->
  <mat-form-field *ngIf="expandedAggregationResult?.sumOtherDocCount" class="aggregation__search">
    <input type="text" placeholder="Search" aria-label="Search" matInput [formControl]="aggregationQuery" [matAutocomplete]="searchAutocomplete">
    <button mat-button *ngIf="aggregationQuery.value" matSuffix mat-icon-button aria-label="Clear" (click)="aggregationQuery.setValue('')">
      <mat-icon>close</mat-icon>
    </button>
    <mat-autocomplete #searchAutocomplete="matAutocomplete" (optionSelected)="autoCompleteOptionSelected($event.option.value)" [displayWith]="queryDisplay">
      <mat-option *ngFor="let option of autoCompleteOptions | async" [value]="option">
        {{option.name}}
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>

  <mat-selection-list (selectionChange)="selectionChanged($event.option.value)">
    <mat-list-option *ngFor="let item of expandedAggregationResult?.aggregationResultItems" checkboxPosition="before" [selected]="item.active"
      [value]="item">
      <div class="aggregation__option-title">
        <div>{{item.getDisplayName(locale)}} </div>
        <div>{{item.count}} </div>
      </div>
    </mat-list-option>
  </mat-selection-list>
  <div>
    <button *ngIf="expandedAggregationResult?.sumOtherDocCount" (click)="loadMore()" mat-button>Show more</button>
    <button *ngIf="expandedAggregationResult?.aggregationResultItems?.length > pagingSize" (click)="loadLess()" mat-button>Show less</button>
  </div>

</mat-expansion-panel>
